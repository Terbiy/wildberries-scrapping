# Wildberries Scrapping

Данный инструмент предназначен для сбора данных товаров с сайта Wildberries.

При использовании команды `make scrap` данные будут сохранены в базу. По умолчанию предполагается, что она работает локальной машине (IP-адрес `127.0.0.1`) на порту `1433`.

При использовании команды `make scrap-to-file` результатом работы инструмента будет текстовый файл формата `tsv` в папке `results`. Смотри [пример](#пример).

Содержимое файла можно скопировать в Excel с сохранением форматирования.

## Настройка

После выгрузки данного репозитория на компьютер необходимо доработать файл с настройками подключения к базе: `src/wildberries_scrapping/database_configuration.clj`. Это делается путём заполнения `connection-settings`.

Там же при необходимости можно указать свойство `:host` или `:port`.

Пример конфигурации:
```clojure
(def connection-settings
  {:user "SA",
   :password "pFo#ZvM7M#yJBy",
   :dbname "Wildberries",
   ;; Указывается, если база подключается к удалённому хосту.
   :host "co-ssas01"
   ;; Указывается, если база работает не на порту 1433.
   :port 1234})
```

При необходимости можно изменить настройки операции вставки данных в базу `insertion-settings`. Их предназначение описано в комментариях.

## Использование

Для работы программы на компьютере должен быть установлен и запущен [Docker Desktop](https://www.docker.com/products/docker-desktop).

В командной строке в корневой папке этого инструмента нужно запустить команду сборки:

```shell
make build
```

Эту команду нужно запускать также после каждого обновления инструмента или при изменении его конфигурации в файле `src/wildberries_scrapping/database_configuration.clj`.

Запуск инструмента для сохранения результатов в базу осуществляется после сборки следующей командой:
```shell
make scrap URL="<адрес страницы Wildberries>"
```

Для сохранения результатов в файл используйте следующую команду:
```shell
make scrap-to-file URL="<адрес страницы Wildberries>"
```

## Пример

Мы хотим посмотреть скидки для брендов Befree, Mango, ZARINA и Zolla и сохранить результаты в файл.

На сайте товары располагаются по следующей ссылке: https://www.wildberries.ru/catalog/zhenshchinam/odezhda?fbrand=4126;2513;4130;65918.

Команда запуска инструмента будет выглядеть следующим образом:

```shell
make scrap-to-file URL="https://www.wildberries.ru/catalog/zhenshchinam/odezhda?fbrand=4126;2513;4130;65918"
```

Результат сбора данных будет доступен в папке `results` в самом свежем файле.

## Лицензия

Использована лицензия MIT.
